<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ™ºæ…§å®¢æœç³»çµ± - æ¡ƒåœ’æ—…å®¢éœ€æ±‚åˆ†æå„€è¡¨æ¿</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1.5" fill="rgba(255,255,255,0.08)"/><circle cx="50" cy="10" r="1" fill="rgba(255,255,255,0.06)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            animation: float 20s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 3px solid #e9ecef;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-tab:hover {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
        }

        .nav-tab.active {
            color: #3498db;
            background: white;
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3498db, #2980b9);
        }

        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .stat-card:hover::before {
            transform: scale(2);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3498db, #e74c3c, #f39c12, #27ae60);
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2c3e50;
            text-align: center;
        }

        .insights-section {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .insights-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .insight-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
        }

        .insight-item h4 {
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .top-list {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .top-list h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.3rem;
        }

        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
            transition: all 0.3s ease;
        }

        .list-item:hover {
            background: #f8f9fa;
            transform: translateX(5px);
        }

        .list-item:last-child {
            border-bottom: none;
        }

        .list-rank {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .list-name {
            flex: 1;
            margin-left: 15px;
            font-weight: 500;
        }

        .list-count {
            background: #ecf0f1;
            color: #7f8c8d;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .recommendations {
            background: linear-gradient(135deg, #55a3ff 0%, #003d82 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .recommendations h3 {
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.5rem;
        }

        .rec-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .rec-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .rec-card h4 {
            margin-bottom: 10px;
            color: #ffeaa7;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #7f8c8d;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <h1>AIæ™ºæ…§å®¢æœç³»çµ± - æ¡ƒåœ’æ—…å®¢éœ€æ±‚åˆ†æå„€è¡¨æ¿</h1>
            <p>æ¡ƒåœ’å¸‚è§€å…‰æ—…éŠæ´è¦‹èˆ‡éŠå®¢è¡Œç‚ºåˆ†æå¹³å°</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview')">ç¸½è¦½çµ±è¨ˆ</button>
            <button class="nav-tab" onclick="showTab('interests')">éœ€æ±‚åˆ†æ</button>
            <button class="nav-tab" onclick="showTab('behavior')">è¡Œç‚ºæ¨¡å¼</button>
            <button class="nav-tab" onclick="showTab('insights')">è§€å…‰æ´è¦‹</button>
        </div>

        <div id="overview" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalQueries">è¼‰å…¥ä¸­...</div>
                    <div class="stat-label">ç¸½æŸ¥è©¢æ•¸</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="uniqueUsers">è¼‰å…¥ä¸­...</div>
                    <div class="stat-label">ç¨ç«‹ç”¨æˆ¶</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="uniqueThreads">è¼‰å…¥ä¸­...</div>
                    <div class="stat-label">å°è©±ä¸²æ•¸</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="refusalRate">è¼‰å…¥ä¸­...</div>
                    <div class="stat-label">æ‹’çµ•æŸ¥è©¢ç‡</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-container">
                    <h3 class="chart-title">æŸ¥è©¢é¡å‹åˆ†å¸ƒ</h3>
                    <canvas id="queryTypeChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">èªè¨€åˆ†å¸ƒ</h3>
                    <canvas id="languageChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">24å°æ™‚æŸ¥è©¢è¶¨å‹¢</h3>
                    <canvas id="hourlyChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">æ¯æ—¥æŸ¥è©¢é‡</h3>
                    <canvas id="dailyChart"></canvas>
                </div>
            </div>
        </div>

        <div id="interests" class="tab-content">
            <div class="chart-grid">
                <div class="top-list">
                    <h3>ç†±é–€èˆˆè¶£é—œéµå­— Top 15</h3>
                    <div id="topInterestsList">è¼‰å…¥ä¸­...</div>
                </div>
                <div class="top-list">
                    <h3>ç†±é–€æŸ¥è©¢åˆ†é¡ Top 10</h3>
                    <div id="topCategoriesList">è¼‰å…¥ä¸­...</div>
                </div>
            </div>
            
            <div class="chart-container">
                <h3 class="chart-title">æ—…å®¢èˆˆè¶£åˆ†å¸ƒåœ–</h3>
                <canvas id="interestsChart"></canvas>
            </div>
        </div>

        <div id="behavior" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="avgQueryLength">è¼‰å…¥ä¸­...</div>
                    <div class="stat-label">å¹³å‡æŸ¥è©¢é•·åº¦</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgUserQueries">è¼‰å…¥ä¸­...</div>
                    <div class="stat-label">ç”¨æˆ¶å¹³å‡æŸ¥è©¢æ¬¡æ•¸</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="top-list">
                    <h3>æœ€æ´»èºç”¨æˆ¶ Top 5</h3>
                    <div id="topUsersList">è¼‰å…¥ä¸­...</div>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">æŸ¥è©¢é•·åº¦åˆ†å¸ƒ</h3>
                    <canvas id="lengthDistChart"></canvas>
                </div>
            </div>
        </div>

        <div id="insights" class="tab-content">
            <div class="insights-section">
                <h3 class="insights-title">æ¡ƒåœ’è§€å…‰æ—…éŠæ ¸å¿ƒæ´è¦‹</h3>
                
                <div class="insight-item">
                    <h4>æ©Ÿå ´æ¥é§æˆç‚ºé¦–è¦éœ€æ±‚</h4>
                    <p>æ©Ÿå ´æ¥é§ç›¸é—œæŸ¥è©¢ä½”ç¸½èˆˆè¶£çš„3.8%ï¼Œé¡¯ç¤ºæ¡ƒåœ’åœ‹éš›æ©Ÿå ´å°æ—…å®¢çš„é‡è¦æ€§ã€‚å»ºè­°åŠ å¼·æ©Ÿå ´åˆ°å¸‚å€å„æ™¯é»çš„æ¥é§æœå‹™è³‡è¨Šï¼Œæ¨å‡ºå³æ™‚æ¥é§ç­æ¬¡æŸ¥è©¢ç³»çµ±ã€‚</p>
                </div>

                <div class="insight-item">
                    <h4>Xparkæ°´æ—é¤¨æŒçºŒç†±é–€</h4>
                    <p>Xparkç›¸é—œæŸ¥è©¢æ’åå‰ä¸‰ï¼ŒåŒ…å«ç¥¨åƒ¹ã€äº¤é€šã€ç‡Ÿæ¥­æ™‚é–“ç­‰ã€‚å»ºè­°æ•´åˆå¥—ç¥¨å„ªæƒ è³‡è¨Šï¼Œæä¾›ç·šä¸Šé ç´„æœå‹™ï¼Œä¸¦çµåˆå‘¨é‚Šæ™¯é»æ¨å‡ºä¸€æ—¥éŠå¥—è£è¡Œç¨‹ã€‚</p>
                </div>

                <div class="insight-item">
                    <h4>å¤œå¸‚ç¾é£Ÿæ–‡åŒ–å—æ­¡è¿</h4>
                    <p>ä¸­å£¢å¤œå¸‚ã€æ¡ƒåœ’å¤œå¸‚æŸ¥è©¢é »ç¹ï¼Œç¾é£Ÿç›¸é—œè©¢å•æ¶µè“‹å¿…åƒæ¨è–¦åˆ°åœè»Šè³‡è¨Šã€‚å»ºè­°æ¨å‡ºå¤œå¸‚ç¾é£Ÿåœ°åœ–APPï¼ŒçµåˆARå°è¦½åŠŸèƒ½ï¼Œæå‡éŠå®¢é«”é©—ã€‚</p>
                </div>

                <div class="insight-item">
                    <h4>è¦ªå­æ—…éŠéœ€æ±‚é¡¯è‘—</h4>
                    <p>è¦ªå­æ™¯é»æŸ¥è©¢ä½”é‡è¦æ¯”ä¾‹ï¼ŒåŒ…å«å°äººåœ‹ã€åŸ”å¿ƒç‰§å ´ç­‰ã€‚å»ºè­°é–‹ç™¼è¦ªå­å‹å–„è¨­æ–½åœ°åœ–ï¼Œæ¨å‡ºè¦ªå­å¥—ç¥¨å„ªæƒ ï¼ŒåŠ å¼·è¦ªå­æ´»å‹•è³‡è¨Šæ¨æ’­ã€‚</p>
                </div>
            </div>

            <div class="recommendations">
                <h3>æ™ºæ…§è§€å…‰ç™¼å±•å»ºè­°</h3>
                <div class="rec-grid">
                    <div class="rec-card">
                        <h4>ç³»çµ±å„ªåŒ–å»ºè­°</h4>
                        <p>â€¢ å¼·åŒ–æ©Ÿå ´æ¥é§å³æ™‚æŸ¥è©¢<br>
                        â€¢ æ•´åˆå¤šèªè¨€æ”¯æ´ï¼ˆå¢åŠ æ—¥éŸ“èªï¼‰<br>
                        â€¢ å»ºç«‹æ™¯é»é ç´„æ•´åˆå¹³å°<br>
                        â€¢ å„ªåŒ–è¡Œå‹•è£ç½®ä½¿ç”¨é«”é©—</p>
                    </div>
                    
                    <div class="rec-card">
                        <h4>æœå‹™æ“´å±•å»ºè­°</h4>
                        <p>â€¢ é–‹ç™¼æ¡ƒåœ’è§€å…‰ä¸€å¡é€š<br>
                        â€¢ å»ºç«‹æ™ºæ…§åœè»Šå°å¼•ç³»çµ±<br>
                        â€¢ æ¨å‡ºARå¯¦å¢ƒå°è¦½æœå‹™<br>
                        â€¢ æ•´åˆé›»å­æ”¯ä»˜èˆ‡å„ªæƒ åˆ¸</p>
                    </div>
                    
                    <div class="rec-card">
                        <h4>è¡ŒéŠ·ç­–ç•¥å»ºè­°</h4>
                        <p>â€¢ æ‰“é€ ã€Œèˆªç©ºåŸè§€å…‰ã€å“ç‰Œ<br>
                        â€¢ å¼·åŒ–è¦ªå­éŠæ†©è¡ŒéŠ·<br>
                        â€¢ ç™¼å±•å·¥æ¥­è§€å…‰ç‰¹è‰²<br>
                        â€¢ æ¨å»£å®¢å®¶æ–‡åŒ–é«”é©—</p>
                    </div>
                    
                    <div class="rec-card">
                        <h4>æ•¸æ“šæ‡‰ç”¨å»ºè­°</h4>
                        <p>â€¢ å»ºç«‹éŠå®¢æµé‡é æ¸¬ç³»çµ±<br>
                        â€¢ é–‹ç™¼å€‹äººåŒ–æ¨è–¦å¼•æ“<br>
                        â€¢ æ•´åˆäº¤é€šæµé‡å¤§æ•¸æ“š<br>
                        â€¢ å»ºç«‹è§€å…‰ç”¢å€¼è©•ä¼°æ¨¡å‹</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ“¬æ¡ƒåœ’è§€å…‰æ•¸æ“š
        function getMockAnalysisData() {
            return {
                // åŸºæœ¬çµ±è¨ˆ
                basic: {
                    totalQueries: 1500,
                    uniqueUsers: 248,
                    uniqueThreads: 367,
                    refusalRate: "4.2"
                },
                
                // èªè¨€åˆ†å¸ƒ
                languages: {
                    "ç¹é«”ä¸­æ–‡": 420,
                    "English": 35,
                    "æ—¥æœ¬èª": 28,
                    "í•œêµ­ì–´": 15,
                    "ç®€ä½“ä¸­æ–‡": 12
                },
                
                // æŸ¥è©¢é¡å‹
                queryTypes: {
                    "äº¤é€š": 125,
                    "æ™¯é»": 168,
                    "ç¾é£Ÿ": 142,
                    "ä½å®¿": 87,
                    "æ´»å‹•": 93,
                    "è³¼ç‰©": 65
                },
                
                // ç†±é–€èˆˆè¶£ï¼ˆæ¡ƒåœ’ç‰¹è‰²ï¼‰
                topInterests: [
                    ["æ©Ÿå ´æ¥é§", 38],
                    ["Xpark", 35],
                    ["ä¸­å£¢å¤œå¸‚", 31],
                    ["å¤§æºªè€è¡—", 28],
                    ["çŸ³é–€æ°´åº«", 25],
                    ["å°äººåœ‹", 23],
                    ["æ‹‰æ‹‰å±±", 22],
                    ["æ…ˆæ¹–", 20],
                    ["æ¡ƒåœ’å¤œå¸‚", 19],
                    ["è¯æ³°åå“åŸ", 18],
                    ["åŸ”å¿ƒç‰§å ´", 17],
                    ["é’å¡˜åœ’", 16],
                    ["è™é ­å±±", 15],
                    ["å®¢å®¶æ–‡åŒ–", 14],
                    ["è§€å…‰å·¥å» ", 13]
                ],
                
                // ç†±é–€åˆ†é¡ï¼ˆæ¡ƒåœ’ç‰¹è‰²ï¼‰
                topCategories: [
                    ["è¦ªå­æ™¯é»", 89],
                    ["å¤œå¸‚ç¾é£Ÿ", 76],
                    ["è³¼ç‰©å•†å ´", 68],
                    ["è‡ªç„¶é¢¨æ™¯", 62],
                    ["æ–‡åŒ–å¤è¹Ÿ", 58],
                    ["æ©Ÿå ´æœå‹™", 52],
                    ["ä¸»é¡Œæ¨‚åœ’", 48],
                    ["ä¼‘é–’è¾²å ´", 45],
                    ["ç™»å±±æ­¥é“", 42],
                    ["è§€å…‰å·¥å» ", 38]
                ],
                
                // æ™‚é–“åˆ†æ
                timeStats: {
                    daily: {
                        "2025-07-01": 145,
                        "2025-07-02": 178,
                        "2025-07-03": 156,
                        "2025-07-04": 189,
                        "2025-07-05": 167,
                        "2025-07-06": 198,
                        "2025-07-07": 212,
                        "2025-07-08": 134,
                        "2025-07-09": 121
                    },
                    hourly: {
                        "0": 28, "1": 18, "2": 12, "3": 8, "4": 6, "5": 9,
                        "6": 22, "7": 38, "8": 56, "9": 68, "10": 72, "11": 75,
                        "12": 82, "13": 78, "14": 71, "15": 69, "16": 65, "17": 58,
                        "18": 52, "19": 48, "20": 42, "21": 38, "22": 32, "23": 30
                    }
                },
                
                // æŸ¥è©¢é•·åº¦çµ±è¨ˆ
                queryLength: {
                    average: "14.8",
                    min: 2,
                    max: 92,
                    median: 14
                },
                
                // æœ€æ´»èºç”¨æˆ¶
                topUsers: [
                    ["A7B9E2F1", 67],
                    ["C3D5A8B2", 45],
                    ["E9F1C4D6", 38],
                    ["B2A7F5E8", 32],
                    ["D6E9A3C1", 28]
                ]
            };
        }

        // è¼‰å…¥å’Œåˆ†ææ•¸æ“šå‡½æ•¸ï¼ˆä½¿ç”¨æ¨¡æ“¬æ•¸æ“šï¼‰
        async function loadAndAnalyzeData() {
            try {
                console.log('ä½¿ç”¨æ¨¡æ“¬æ•¸æ“šè¼‰å…¥...');
                
                // æ¨¡æ“¬è¼‰å…¥æ™‚é–“
                await new Promise(resolve => setTimeout(resolve, 500));
                
                const analysisResults = getMockAnalysisData();
                
                console.log('æ¨¡æ“¬æ•¸æ“šè¼‰å…¥å®Œæˆ');
                
                // å­˜å„²åˆ°å…¨åŸŸè®Šæ•¸
                window.taoyuanAnalysisData = analysisResults;
                
                return analysisResults;
                
            } catch (error) {
                console.error('è¼‰å…¥æ•¸æ“šå¤±æ•—:', error);
                throw error;
            }
        }

        // è¼”åŠ©å‡½æ•¸ï¼šè¨ˆæ•¸
        function countBy(array, key) {
            const result = {};
            if (typeof key === 'string') {
                array.forEach(item => {
                    const val = item[key];
                    result[val] = (result[val] || 0) + 1;
                });
            } else {
                array.forEach(item => {
                    result[item] = (result[item] || 0) + 1;
                });
            }
            return result;
        }

        // è¼”åŠ©å‡½æ•¸ï¼šå–å¾—æ’åºå¾Œçš„å‰Né …
        function getTopEntries(obj, limit) {
            return Object.entries(obj)
                .sort((a, b) => b[1] - a[1])
                .slice(0, limit);
        }

        // å…¨åŸŸè®Šæ•¸
        let chartInstances = {};

        // é ç±¤åˆ‡æ›å‡½æ•¸
        function showTab(tabName) {
            // éš±è—æ‰€æœ‰å…§å®¹
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„activeé¡åˆ¥
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // é¡¯ç¤ºé¸ä¸­çš„å…§å®¹
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // åˆå§‹åŒ–å‡½æ•¸
        async function initializeDashboard() {
            try {
                // é¡¯ç¤ºè¼‰å…¥ä¸­ç‹€æ…‹
                showLoadingState();
                
                console.log('é–‹å§‹åˆå§‹åŒ–å„€è¡¨æ¿...');
                
                // è¼‰å…¥æ•¸æ“š
                const data = await loadAndAnalyzeData();
                
                if (!data) {
                    throw new Error('æ•¸æ“šè¼‰å…¥å¤±æ•—');
                }

                console.log('æ•¸æ“šè¼‰å…¥æˆåŠŸï¼Œé–‹å§‹æ›´æ–°ç•Œé¢...');
                
                // æ›´æ–°åŸºæœ¬çµ±è¨ˆ
                console.log('æ›´æ–°åŸºæœ¬çµ±è¨ˆæ•¸æ“š...');
                document.getElementById('totalQueries').textContent = data.basic.totalQueries.toLocaleString();
                document.getElementById('uniqueUsers').textContent = data.basic.uniqueUsers.toLocaleString();
                document.getElementById('uniqueThreads').textContent = data.basic.uniqueThreads.toLocaleString();
                document.getElementById('refusalRate').textContent = data.basic.refusalRate + '%';

                // è¨ˆç®—é¡å¤–çµ±è¨ˆ
                document.getElementById('avgQueryLength').textContent = data.queryLength.average;
                document.getElementById('avgUserQueries').textContent = (data.basic.totalQueries / data.basic.uniqueUsers).toFixed(1);

                console.log('å‰µå»ºåœ–è¡¨...');
                // å‰µå»ºåœ–è¡¨
                createQueryTypeChart(data.queryTypes);
                createLanguageChart(data.languages);
                createHourlyChart(data.timeStats.hourly);
                createDailyChart(data.timeStats.daily);
                createInterestsChart(data.topInterests);
                
                console.log('å‰µå»ºæ’è¡Œæ¦œ...');
                // å‰µå»ºæ’è¡Œæ¦œ
                createTopInterestsList(data.topInterests);
                createTopCategoriesList(data.topCategories);
                createTopUsersList(data.topUsers);
                
                console.log('å„€è¡¨æ¿åˆå§‹åŒ–å®Œæˆï¼');
                
                // éš±è—è¼‰å…¥ç‹€æ…‹
                hideLoadingState();
                
            } catch (error) {
                console.error('Dashboard initialization failed:', error);
                showErrorState(error.message);
            }
        }

        // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
        function showLoadingState() {
            const elements = ['totalQueries', 'uniqueUsers', 'uniqueThreads', 'refusalRate', 'avgQueryLength', 'avgUserQueries'];
            elements.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerHTML = '<span style="color: #3498db;">è¼‰å…¥ä¸­...</span>';
            });
            
            // æ¸…ç©ºåˆ—è¡¨
            const lists = ['topInterestsList', 'topCategoriesList', 'topUsersList'];
            lists.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerHTML = '<div style="text-align: center; padding: 20px; color: #7f8c8d;">ğŸ“Š æ­£åœ¨åˆ†ææ•¸æ“š...</div>';
            });
        }

        // éš±è—è¼‰å…¥ç‹€æ…‹
        function hideLoadingState() {
            console.log('âœ… å„€è¡¨æ¿è¼‰å…¥å®Œæˆï¼æ‰€æœ‰åœ–è¡¨å’Œçµ±è¨ˆæ•¸æ“šå·²æº–å‚™å°±ç·’ã€‚');
        }

        // é¡¯ç¤ºéŒ¯èª¤ç‹€æ…‹
        function showErrorState(message) {
            const elements = ['totalQueries', 'uniqueUsers', 'uniqueThreads', 'refusalRate', 'avgQueryLength', 'avgUserQueries'];
            elements.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerHTML = '<span style="color: #e74c3c;">è¼‰å…¥å¤±æ•—</span>';
            });
            console.error('âŒ è¼‰å…¥éŒ¯èª¤:', message);
        }

        // å‰µå»ºæŸ¥è©¢é¡å‹åœ–è¡¨
        function createQueryTypeChart(data) {
            const ctx = document.getElementById('queryTypeChart');
            if (!ctx) return;
            
            if (chartInstances.queryType) {
                chartInstances.queryType.destroy();
            }
            
            const labels = Object.keys(data);
            const values = Object.values(data);
            
            chartInstances.queryType = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: values,
                        backgroundColor: [
                            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            console.log('æŸ¥è©¢é¡å‹åœ–è¡¨å‰µå»ºå®Œæˆ');
        }

        // å‰µå»ºèªè¨€åˆ†å¸ƒåœ–è¡¨
        function createLanguageChart(data) {
            const ctx = document.getElementById('languageChart');
            if (!ctx) return;
            
            if (chartInstances.language) {
                chartInstances.language.destroy();
            }
            
            chartInstances.language = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(data),
                    datasets: [{
                        data: Object.values(data),
                        backgroundColor: ['#FF9F43', '#10AC84', '#5F27CD', '#EE5A6F', '#48DBFB'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            console.log('èªè¨€åˆ†å¸ƒåœ–è¡¨å‰µå»ºå®Œæˆ');
        }

        // å‰µå»ºæ¯å°æ™‚æŸ¥è©¢åœ–è¡¨
        function createHourlyChart(data) {
            const ctx = document.getElementById('hourlyChart');
            if (!ctx) return;
            
            if (chartInstances.hourly) {
                chartInstances.hourly.destroy();
            }
            
            // æº–å‚™24å°æ™‚æ•¸æ“š
            const hours = Array.from({length: 24}, (_, i) => i);
            const counts = hours.map(hour => data[hour] || 0);
            
            chartInstances.hourly = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: hours.map(h => h + ':00'),
                    datasets: [{
                        label: 'æŸ¥è©¢æ¬¡æ•¸',
                        data: counts,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            console.log('æ¯å°æ™‚æŸ¥è©¢åœ–è¡¨å‰µå»ºå®Œæˆ');
        }

        // å‰µå»ºæ¯æ—¥æŸ¥è©¢åœ–è¡¨
        function createDailyChart(data) {
            const ctx = document.getElementById('dailyChart');
            if (!ctx) return;
            
            if (chartInstances.daily) {
                chartInstances.daily.destroy();
            }
            
            chartInstances.daily = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(data),
                    datasets: [{
                        label: 'æŸ¥è©¢æ¬¡æ•¸',
                        data: Object.values(data),
                        backgroundColor: 'rgba(231, 76, 60, 0.8)',
                        borderColor: '#e74c3c',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            console.log('æ¯æ—¥æŸ¥è©¢åœ–è¡¨å‰µå»ºå®Œæˆ');
        }

        // å‰µå»ºèˆˆè¶£åˆ†å¸ƒåœ–è¡¨
        function createInterestsChart(data) {
            const ctx = document.getElementById('interestsChart');
            if (!ctx) return;
            
            if (chartInstances.interests) {
                chartInstances.interests.destroy();
            }
            
            chartInstances.interests = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.map(item => item[0]),
                    datasets: [{
                        label: 'æŸ¥è©¢æ¬¡æ•¸',
                        data: data.map(item => item[1]),
                        backgroundColor: 'rgba(46, 204, 113, 0.8)',
                        borderColor: '#2ecc71',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });
            console.log('èˆˆè¶£åˆ†å¸ƒåœ–è¡¨å‰µå»ºå®Œæˆ');
        }

        // å‰µå»ºç†±é–€èˆˆè¶£åˆ—è¡¨
        function createTopInterestsList(data) {
            const container = document.getElementById('topInterestsList');
            if (!container) return;
            
            container.innerHTML = data.map((item, index) => `
                <div class="list-item">
                    <div class="list-rank">${index + 1}</div>
                    <div class="list-name">${item[0]}</div>
                    <div class="list-count">${item[1]}</div>
                </div>
            `).join('');
            console.log('ç†±é–€èˆˆè¶£åˆ—è¡¨å‰µå»ºå®Œæˆ');
        }

        // å‰µå»ºç†±é–€åˆ†é¡åˆ—è¡¨
        function createTopCategoriesList(data) {
            const container = document.getElementById('topCategoriesList');
            if (!container) return;
            
            container.innerHTML = data.map((item, index) => `
                <div class="list-item">
                    <div class="list-rank">${index + 1}</div>
                    <div class="list-name">${item[0]}</div>
                    <div class="list-count">${item[1]}</div>
                </div>
            `).join('');
            console.log('ç†±é–€åˆ†é¡åˆ—è¡¨å‰µå»ºå®Œæˆ');
        }

        // å‰µå»ºæœ€æ´»èºç”¨æˆ¶åˆ—è¡¨
        function createTopUsersList(data) {
            const container = document.getElementById('topUsersList');
            if (!container) return;
            
            container.innerHTML = data.map((item, index) => `
                <div class="list-item">
                    <div class="list-rank">${index + 1}</div>
                    <div class="list-name">ç”¨æˆ¶ ${item[0].substring(0, 8)}...</div>
                    <div class="list-count">${item[1]} æ¬¡</div>
                </div>
            `).join('');
            console.log('æœ€æ´»èºç”¨æˆ¶åˆ—è¡¨å‰µå»ºå®Œæˆ');
        }

        // é é¢åŠ è¼‰å®Œæˆå¾Œåˆå§‹åŒ–
        window.addEventListener('load', function() {
            // ç«‹å³åŸ·è¡Œåˆå§‹åŒ–
            initializeDashboard();
        });
    </script>
</body>
</html>